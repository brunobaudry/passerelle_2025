<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');body,#timer,input, button,select,option, .tooltip::after {font-family: 'Press Start 2P', mono;}
           body{background:#000;color:#fff;padding:0 50px}#lifes{position:absolute;right:8px;top:0}h1{font-size:2rem;text-align:left;text-shadow:2px 2px 4px #000}h1,h2{animation:flicker 1.5s infinite alternate;color:#0f0}#timer{display:inline-block;font-family:Press Start 2P,cursive;font-size:1.5rem}.blink{animation:blink 1s step-end infinite}.correct{animation:correctAnim .5s ease-in-out;color:#0f0}.wrong{animation:wrongAnim .5s ease-in-out;background-color:red;padding:2px 4px}.warn{animation:correctAnim .3s ease-in-out infinite;color:orange}@keyframes blink{50%{opacity:0}}@keyframes flicker{0%,to{opacity:1}50%{opacity:.5}}@keyframes correctAnim{0%,to{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(1.5)}}@keyframes wrongAnim{0%,to{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.5)}}button,input{background-color:#333;border:0;border-radius:5px;box-shadow:0 4px 6px rgba(0,0,0,.1);color:#fff;font-family:Press Start 2P,cursive;margin:10px;padding:10px;transition:transform .2s,background-color .2s}button:focus,input:focus,select:focus{box-shadow:#e5ff00 0 0 1pc;outline:0;transform:scale(1.05)}button{background-color:#00bfff;color:#000;cursor:pointer}button:hover{background-color:#00bfff;transform:scale(1.1)}#texts{background:hsla(0,0%,100%,.1);border-radius:8px;margin:5px 0;padding:10px;transition:transform .2s;width:90%}table{list-style:none;padding:0;width:100%}th{color:orange}tr{background:hsla(0,0%,100%,.1);border-radius:5px;box-shadow:0 4px 6px rgba(0,0,0,.1);margin:5px 0;padding:10px;transition:transform .2s}hr{background-color:hsla(0,0%,100%,.1);border:0;height:2px}td,th{padding:6px}ol li:hover{transform:scale(1.05)}#startgame{display:inline-block}.container{display:flex;justify-content:right}.item{flex-grow:1;width:50%}.item p{padding:6px}[contenteditable=true]:focus{border:0;box-shadow:none;outline:0}select{-moz-appearance:none;-webkit-appearance:none;appearance:none;background-color:#333;background-image:url(data:image/svg+xml;utf8,<svg\ fill='white'\ height='24'\ viewBox='0\ 0\ 24\ 24'\ width='24'\ xmlns='http://www.w3.org/2000/svg'><path\ d='M7\ 10l5\ 5\ 5-5z'/></svg>);background-position:right 10px center;background-repeat:no-repeat;background-size:1pc;border:0;border-radius:5px;box-shadow:0 4px 6px rgba(0,0,0,.1);color:#fff;cursor:pointer;font-family:Press Start 2P,cursive;margin:10px;padding:10px;position:relative;transition:transform .2s,background-color .2s}select:focus{background-color:#444;outline:0;transform:scale(1.05)}option{background-color:#000;color:#fff;font-family:Press Start 2P,cursive}.tooltip{position:relative}.tooltip:after{background-color:#000;border:2px solid #0f0;border-radius:4px;bottom:110%;color:#0f0;content:attr(data-tooltip);font-family:Press Start 2P,cursive;font-size:.6em;left:50%;opacity:0;padding:6px 8px;pointer-events:none;position:absolute;text-shadow:1px 1px 2px #000;transform:translatex(-50%);transition:opacity .3s ease;white-space:nowrap;z-index:100}.tooltip:hover:after{opacity:1}.modal{align-items:center;background-color:rgba(0,0,0,.9);display:none;height:100%;justify-content:center;left:0;position:fixed;top:0;width:100%;z-index:1000}.modal.active{display:flex;flex-direction:column}.modal-content{background-color:#000;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,.2);max-width:50%;padding:2rem;position:relative;width:100%}.modal-close{background:0;border:0;color:red;cursor:pointer;font-size:1.5rem;position:absolute;right:.5rem;top:.5rem}
        </style>
        <script>
            this.onload=async()=>{let e="Anonymous",r="",t=500,n=t,a=0,o=0,l=0,s=[],c=!1,d=e,i=!1,u=!1,j="https://random-words-api.kushcreates.com",g=[],m=new Map,v=new Map,p=new Map,h=new Map,B=1,L=3,D=5,y=new Map,w=(y.set(0,160),y.set(1,80),y.set(2,50),y.set(3,20),document.querySelector("#randomword")),q=document.querySelector("#timer"),F=document.querySelector("#startgame"),E=document.querySelector("#userlevel"),S=document.querySelector("#allRecords"),k=document.querySelector("#leaderboard"),b=document.querySelector("#nb"),f=document.querySelector("#len"),P=document.querySelector("#languages"),M=document.querySelector("#categories"),C=document.querySelector("#typedword"),U=document.querySelector("#addUser"),x=document.querySelector("#users"),A=document.querySelector("#userinput");let H=()=>{var e=h.get(d);E.textContent="level "+p.get(d),b.value=e.contWords,f.value=e.wordLength},z=e=>{h.set(d,{contWords:parseInt(b.value),wordLength:parseInt(f.value)})},O=e=>{var t;console.log("initUser",e),-1==g.indexOf(e)?(g.push(e),(t=document.createElement("option")).value=e,t.textContent=e,x.appendChild(t),x.selectedIndex=x.children.length-1,Q(e),d=e,H(),W()):alert(e+" already exists, find another name !")},R=e=>{e.stopPropagation();var t=e.key;"Dead"===t?c=!0:(c=!1,"Enter"===t?N():0<a&&("Backspace"===e.key||"Delete"===e.key)&&(T(B),$(),X(null)))},T=e=>{m.set(d,m.get(d)+e)},G=(t,n)=>{for(let e=0;e<t.length;e++)J(t[e],0===e,n)},J=(e,t,n)=>{var a=document.createElement("option");a.innerHTML=e,a.setAttribute("id",e),a.setAttribute("name","lang"),a.checked=t,n.appendChild(a),n.appendChild(document.createElement("br"))},K=()=>{var e=h.get(d);b.value=e.contWords,f.value=e.wordLength,q.classList=[],E.classList=[],C.focus()};async function N(){var e;clearInterval(l),K(),e=await(async()=>{let e=document.querySelector("[name='lang']:checked"),t="";f.value&&(t+="&length="+f.value),b.value&&(t+="&words="+b.value),e.value&&(t+="&language="+e.value),M.value&&(t+="&category="+M.value);{var[n,a=""]=["api",t];let e=j+"/"+n;return await(""!=a&&(e+="?"+a),n=await fetch(e),a=await n.json())}})(),r=e.map(e=>e.word).join(" "),W(),await!(w.innerHTML=r),i||n==t||(T(L),$()),t=r.length*y.get(p.get(d))+20,a=0,n=t,l=setInterval(V,10),u=!0}let Q=e=>{m.has(e)||m.set(e,0),v.has(e)||v.set(e,0),p.has(e)||p.set(e,1),h.has(e)||h.set(e,{contWords:1,wordLength:2,gameover:!1})},W=()=>{w.innerHTML="",C.innerHTML=C.value=""};let V=()=>{a=(n--/100).toFixed(2),o=t-n,q.textContent=a+"s",a<=0?I(!1):n<.25*t&&(q.classList=["warn"])},X=e=>{let t=C.textContent;u&&(null==e&&(t=t.slice(-1)),c||(w.innerHTML=Y(t)),Z())},Y=t=>{let n="";var e=r.substring(t.length);for(let e=0;e<Math.min(r.length,t.length);e++){var a=t[e].replace(/ /g," ").charCodeAt(0),o=r[e].replace(/ /g," ").charCodeAt(0);n+=a==o?`<span class="correct">${r[e]}</span>`:`<span class="wrong">${r[e]}</span>`}return n+e},Z=()=>{C.textContent===r&&(i=!0,I(i))},ee=e=>{s.push({time:(o/e.length).toFixed(0),word:e,user:d}),s.sort((e,t)=>e.time-t.time),s=s.slice(0,6),S.innerHTML="",s.forEach(e=>{var t=document.createElement("tr");t.innerHTML=`<td>${e.user}</td><td>${e.time}</td>`,t.classList.add("tooltip"),t.setAttribute("data-tooltip","Word(s): "+e.word),S.appendChild(t)})},te=()=>{for(var e in k.innerHTML="",g){var e=g[e],t=(ne(e),document.createElement("tr"));t.innerHTML=`<td>${e}</td><td>${p.get(e)}</td><td>${100*v.get(e)}</td>`,t.classList.add("tooltip"),t.setAttribute("data-tooltip","Penalties "+m.get(e)),k.appendChild(t)}},ne=e=>{var t,n=p.get(e);0<v.get(e)-10*(n+1)&&(t=h.get(d),h.set(d,{contWords:++t.contWords,wordLength:t.wordLength}),p.set(e,++n),E.classList.add("blink"),H())},I=e=>{u=!1,e?(q.classList=["correct"],e=h.get(d),h.set(d,{contWords:e.contWords,wordLength:++e.wordLength}),v.set(d,v.get(d)+D),ee(C.textContent)):(T(L),q.classList=["wrong"]),clearInterval(l),q.classList.add("blink"),C.blur(),te(),$()},$=()=>{var t=m.get(d),n=50*(5-p.get(d))/2/5;for(let e=0;e<5;e++){var a=document.getElementById("heart"+e),o=e*n,r=(e+1)*n;t<=o?a.style.opacity=1:r<=t?(a.style.opacity=0,4==e&&(gameover=!0)):(a.style.opacity=1-(r=(t-o)/n),console.log(r))}};G(["en","es","hi","gu","de","fr","it","zh","pt-br"],P),G(["all","capitals_of_countries","countries","sports","animals","birds","softwares","programming_languages","games","pc_games","mobile_games","console_games","companies"],M),d=e,O(d),U.addEventListener("click",e=>{console.log("click",d),""!==A.value.trim()&&(u&&I(!1),O(A.value))}),x.addEventListener("change",e=>{u&&I(!1),d=x.value,H(),W(),console.log(h)}),b.addEventListener("click",z),f.addEventListener("click",z),C.addEventListener("input",X),F.addEventListener("click",N),document.addEventListener("keydown",R);var ae=document.querySelectorAll("[data-modal-open]"),oe=document.querySelectorAll("[data-modal-close]");let _=document.querySelector("#modalsettings");console.log(ae),ae.forEach(e=>e.addEventListener("click",e=>{e.target.closest("#settings")?(_=document.querySelector("#modalsettings"),console.log(e.target)):e.target.closest("#boards")&&(_=document.querySelector("#modalboards")),console.log(_.id),_.classList.add("active")})),oe.forEach(e=>e.addEventListener("click",()=>{_.classList.remove("active"),console.log(_)})),window.addEventListener("click",e=>{e.target===_&&(_.classList.remove("active"),console.log(_))})};
        </script>
    </head>
    <body>
        <div id="lifes">
            <svg id="heart0" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart1" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart2" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart3" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart4" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
        </div>
      <div>
        <div>
        <button data-modal-open class="button" id="settings">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#000000" ><path d="M686-132 444-376q-20 8-40.5 12t-43.5 4q-100 0-170-70t-70-170q0-36 10-68.5t28-61.5l146 146 72-72-146-146q29-18 61.5-28t68.5-10q100 0 170 70t70 170q0 23-4 43.5T584-516l244 242q12 12 12 29t-12 29l-84 84q-12 12-29 12t-29-12Zm29-85 27-27-256-256q18-20 26-46.5t8-53.5q0-60-38.5-104.5T386-758l74 74q12 12 12 28t-12 28L332-500q-12 12-28 12t-28-12l-74-74q9 57 53.5 95.5T360-440q26 0 52-8t47-25l256 256ZM472-488Z"/></svg>
        </button>
        <button data-modal-open class="button" id="boards">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#000"><path d="M620-360q-17 0-28.5-11.5T580-400v-160q0-17 11.5-28.5T620-600h100q17 0 28.5 11.5T760-560v160q0 17-11.5 28.5T720-360H620Zm20-60h60v-120h-60v120Zm-440 60v-100q0-17 11.5-28.5T240-500h80v-40H200v-60h140q17 0 28.5 11.5T380-560v60q0 17-11.5 28.5T340-460h-80v40h120v60H200Zm250-160v-60h60v60h-60Zm0 140v-60h60v60h-60ZM160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h120v-80h80v80h240v-80h80v80h120q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm0-80h290v-60h60v60h290v-480H510v60h-60v-60H160v480Zm0 0v-480 480Z"/></svg>
        </button>

        <h1>Typing Game</h1>
        <p>
          <label for="users">User:</label>
          <select id="users" name="selectusers"></select
          ><span id="userlevel"></span>
          <button id="startgame" title="Start game">
            <svg height="24px" viewBox="0 -960 960 960" width="24px" fill="#000" xmlns="http://www.w3.org/2000/svg"><path d="M360-720h80v-80h-80v80Zm160 0v-80h80v80h-80ZM360-400v-80h80v80h-80Zm320-160v-80h80v80h-80Zm0 160v-80h80v80h-80Zm-160 0v-80h80v80h-80Zm160-320v-80h80v80h-80Zm-240 80v-80h80v80h-80ZM200-160v-640h80v80h80v80h-80v80h80v80h-80v320h-80Zm400-320v-80h80v80h-80Zm-160 0v-80h80v80h-80Zm-80-80v-80h80v80h-80Zm160 0v-80h80v80h-80Zm80-80v-80h80v80h-80Z"/></svg>
          </button>
        </p>
        <p>time: <span id="timer" class="">0.00s</span></p>
        <div id="texts">
          <p contenteditable="true" type="textarea" id="typedword">&nbsp;</p>
          <p id="randomword">&nbsp;</p>
        </div>
      </div>
    </div>
    <hr />

    <div class="modal" id="modalsettings">
      <div class="modal-content">
        <button data-modal-close class="modal-close">&times;</button>
        <div class="item">
          <h2>Settings</h2>
          <input id="userinput" placeholder="Username" /><button id="addUser">
            add</button
          ><br />
          <label for="nb">Number of words</label>
          <input
            type="number"
            id="nb"
            width="40"
            max="10"
            min="1"
            value="1"
          /><br />
          <label for="len">Length of words</label>
          <input
            type="number"
            id="len"
            width="40"
            max="10"
            min="2"
            value="2"
          /><br />
          <label for="languages">Languages</label>
          <select id="languages" title="languages"></select
          ><br />
          <label for="categories">Categories</label>
          <select id="categories" title="categories"></select>
        </div>
      </div>
    </div>
    <div class="modal" id="modalboards">
      <div class="modal-content">
        <button data-modal-close class="modal-close">&times;</button>
        <div class="item">
          <h2>Records</h2>
          <table>
            <thead>
              <tr>
                <th>User</th>
                <th>ms/char</th>
              </tr>
            </thead>
            <tbody id="allRecords"></tbody>
          </table>
        </div>
        <div class="item">
          <h2>Leaders</h2>
          <table>
            <thead>
              <tr>
                <th>User</th>
                <th>Level</th>
                <th>Points</th>
              </tr>
            </thead>
            <tbody id="leaderboard"></tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
