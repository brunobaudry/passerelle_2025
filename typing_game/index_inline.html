<!DOCTYPE html>
<html>
    <head>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');body,#timer,input, button,select,option, .tooltip::after {font-family: 'Press Start 2P', cursive;}
            body{background:#000;color:#fff;padding:50px}#lifes{position:absolute;right:8px;top:0}h1{animation:flicker 1.5s infinite alternate;color:#0f0;font-size:2em;text-shadow:2px 2px 4px #000}@keyframes flicker{0%,to{opacity:1}50%{opacity:.5}}#timer{font-family:Press Start 2P,cursive;font-size:1.5em}.blink{animation:blink 1s step-end infinite}@keyframes blink{50%{opacity:0}}.correct{animation:correctAnim .5s ease-in-out;color:#0f0;font-weight:700}.wrong{animation:wrongAnim .5s ease-in-out;background-color:red;font-weight:700}@keyframes correctAnim{0%,to{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(1.5)}}@keyframes wrongAnim{0%,to{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.5)}}button,input{background-color:#333;border:0;border-radius:5px;box-shadow:0 4px 6px rgba(0,0,0,.1);color:#fff;font-family:Press Start 2P,cursive;margin:10px;padding:10px;transition:transform .2s,background-color .2s}button:focus,input:focus,select:focus{box-shadow:#0f0 0 0 1pc;outline:0;transform:scale(1.05)}button{background-color:#0f0;color:#000;cursor:pointer}button:hover{background-color:#0c0;transform:scale(1.1)}ol{list-style:none;padding:0}ol li{background:hsla(0,0%,100%,.1);border-radius:5px;box-shadow:0 4px 6px rgba(0,0,0,.1);margin:5px 0;padding:10px;transition:transform .2s}ol li:hover{transform:scale(1.05)}#startgame{display:inline-block}.container{display:flex;justify-content:center}.item{flex-grow:4}.item p{padding:6px}[contenteditable=true]:focus{border:0;box-shadow:none;outline:0}select{-moz-appearance:none;-webkit-appearance:none;appearance:none;background-color:#333;background-image:url(data:image/svg+xml;utf8,<svg\ fill='white'\ height='24'\ viewBox='0\ 0\ 24\ 24'\ width='24'\ xmlns='http://www.w3.org/2000/svg'><path\ d='M7\ 10l5\ 5\ 5-5z'/></svg>);background-position:right 10px center;background-repeat:no-repeat;background-size:1pc;border:0;border-radius:5px;box-shadow:0 4px 6px rgba(0,0,0,.1);color:#fff;cursor:pointer;font-family:Press Start 2P,cursive;margin:10px;padding:10px;position:relative;transition:transform .2s,background-color .2s}select:focus{background-color:#444;outline:0;transform:scale(1.05)}option{background-color:#000;color:#fff;font-family:Press Start 2P,cursive}.tooltip{position:relative}.tooltip:after{background-color:#000;border:2px solid #0f0;border-radius:4px;bottom:110%;color:#0f0;content:attr(data-tooltip);font-family:Press Start 2P,cursive;font-size:.6em;left:50%;opacity:0;padding:6px 8px;pointer-events:none;position:absolute;text-shadow:1px 1px 2px #000;transform:translatex(-50%);transition:opacity .3s ease;white-space:nowrap;z-index:100}.tooltip:hover:after{opacity:1}
        </style>
        <!-- <link rel="stylesheet" href="static/css/style.min.css"> -->
        <script src="static/js/typing_game.min.js">
            this.onload=async()=>{let n="Anonymous",o="",t=500,a=t,r=0,l=0,s=[],c=!1,d=n,i=!1,u=!1,B="https://random-words-api.kushcreates.com",g=[],m=new Map,p=new Map,v=new Map,h=new Map,D=1,y=3,O=5,L=new Map,w=(L.set(0,160),L.set(1,80),L.set(2,50),L.set(3,20),document.querySelector("#randomword")),b=document.querySelector("#timer"),U=document.querySelector("#startgame"),k=document.querySelector("#userlevel"),q=document.querySelector("#allRecords"),E=document.querySelector("#leaderboard"),S=document.querySelector("#nb"),f=document.querySelector("#len"),$=document.querySelector("#languages"),C=document.querySelector("#categories"),M=document.querySelector("#typedword"),z=document.querySelector("#addUser"),x=document.querySelector("#users"),W=document.querySelector("#userinput");let A=()=>{var e=h.get(d);k.textContent="level "+v.get(d),S.value=e.contWords,f.value=e.wordLength},e=e=>{h.set(d,{contWords:parseInt(S.value),wordLength:parseInt(f.value)})},H=e=>{var t;console.log("initUser",e),-1==g.indexOf(e)?(0==g.indexOf(n)&&(g.length=0),g.push(e),(t=document.createElement("option")).value=e,(t.textContent=e)==n&&(t.disabled=!0),x.appendChild(t),x.selectedIndex=x.children.length-1,K(e),d=e,A(),T()):alert(e+" already exists, find another name !")},F=e=>{e.stopPropagation();var t=e.key;"Dead"===t?c=!0:(c=!1,"Enter"===t?J():0<r&&("Backspace"===e.key||"Delete"===e.key)&&(I(D),j(),Q(null)))},I=e=>{m.set(d,m.get(d)+e)},P=(t,n)=>{for(let e=0;e<t.length;e++)R(t[e],0===e,n)},R=(e,t,n)=>{var a=document.createElement("option");a.innerHTML=e,a.setAttribute("id",e),a.setAttribute("name","lang"),a.checked=t,n.appendChild(a),n.appendChild(document.createElement("br"))},G=()=>{var e=h.get(d);S.value=e.contWords,f.value=e.wordLength,b.classList=[],k.classList=[],M.focus()};async function J(){var e;clearInterval(l),G(),e=await(async()=>{let e=document.querySelector("[name='lang']:checked"),t="";f.value&&(t+="&length="+f.value),S.value&&(t+="&words="+S.value),e.value&&(t+="&language="+e.value),C.value&&(t+="&category="+C.value);{var[n,a=""]=["api",t];let e=B+"/"+n;return await(""!=a&&(e+="?"+a),n=await fetch(e),a=await n.json())}})(),o=e.map(e=>e.word).join(" "),T(),await!(w.innerHTML=o),console.log(!i,a,t,a!=t,!i&&a!=t),i||a==t||(I(y),j()),K(d),t=o.length*L.get(v.get(d))+20,r=0,a=t,l=setInterval(N,10),u=!0}let K=e=>{m.has(e)||m.set(e,0),p.has(e)||p.set(e,0),v.has(e)||v.set(e,0),h.has(e)||h.set(e,{contWords:1,wordLength:2})},T=()=>{w.innerHTML="",M.innerHTML=M.value=""};let N=()=>{r=(a--/100).toFixed(2),b.textContent="time: "+r+" s",r<=0&&_(!1)},Q=e=>{let t=M.textContent;u&&(null==e&&(t=t.slice(-1)),c||(w.innerHTML=V(t)),X(t))},V=t=>{let n="";var e=o.substring(t.length);for(let e=0;e<Math.min(o.length,t.length);e++){var a=t[e].replace(/ /g," ").charCodeAt(0),r=o[e].replace(/ /g," ").charCodeAt(0);n+=a==r?`<span class="correct">${o[e]}</span>`:`<span class="wrong">${o[e]}</span>`}return n+e},X=e=>{e===o&&(i=!0,_(i),Y(e))},Y=e=>{s.push({time:r,word:e,user:d}),s.sort((e,t)=>e.time-t.time),s=s.slice(0,6),q.innerHTML="",s.forEach(e=>{var t=document.createElement("li");t.textContent=e.time+"s "+e.user,t.classList.add("tooltip"),t.setAttribute("data-tooltip","Word(s): "+e.word),q.appendChild(t)})},Z=()=>{for(var e in E.innerHTML="",g){var e=g[e],t=(ee(e),document.createElement("li"));t.textContent=e+" "+p.get(e),t.classList.add("tooltip"),t.setAttribute("data-tooltip","level "+v.get(e)),E.appendChild(t)}},ee=e=>{var t,n=v.get(e);0<p.get(e)-10*(n+1)&&(t=h.get(d),h.set(d,{contWords:++t.contWords,wordLength:t.wordLength}),v.set(e,++n),k.classList.add("blink"),A())},_=e=>{u=!1,e?(b.classList.add("correct"),e=h.get(d),h.set(d,{contWords:e.contWords,wordLength:++e.wordLength}),p.set(d,p.get(d)+O)):(I(y),b.classList.add("wrong")),Z(),clearInterval(l),b.classList.add("blink"),M.blur(),j()},j=()=>{var t=m.get(d),e=50*(5-v.get(d)),n=(console.log(e),e/5);for(let e=0;e<5;e++){var a=document.getElementById("heart"+e),r=e*n,o=(e+1)*n;t<=r?a.style.opacity=1:o<=t?a.style.opacity=0:(a.style.opacity=1-(o=(t-r)/n),console.log(o))}};P(["en","es","hi","gu","de","fr","it","zh","pt-br"],$),P(["all","capitals_of_countries","countries","sports","animals","birds","softwares","programming_languages","games","pc_games","mobile_games","console_games","companies"],C),d=n,H(d),z.addEventListener("click",e=>{console.log("click",d),""!==W.value.trim()&&H(W.value)}),x.addEventListener("change",e=>{u&&_(!1),d=x.value,A(),T(),console.log(h)}),S.addEventListener("click",e),f.addEventListener("click",e),M.addEventListener("input",Q),U.addEventListener("click",J),document.addEventListener("keydown",F)};
        </script>
        
    </head>
    <body>
        <div id="lifes">
            <svg id="heart0" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart1" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart2" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart3" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
            <svg id="heart4" class="heart full" width=32 height=32 viewBox="0 0 32 32" xmlns=http://www.w3.org/2000/svg fill=#ff0000><g><rect x=10 y=6 width=4 height=2 /><rect x=22 y=6 width=4 height=2 /></g><g><rect x=8 y=8 width=8 height=4 /><rect x=20 y=8 width=8 height=4 /></g><g><rect x=6 y=12 width=4 height=4 /><rect x=10 y=12 width=16 height=4 /><rect x=26 y=12 width=4 height=4 /></g><g><rect x=8 y=16 width=16 height=4 /><rect x=24 y=16 width=4 height=4 /></g><g><rect x=12 y=20 width=12 height=4 /></g><rect x=16 y=24 width=4 height=3 /></svg>
        </div>
    <h1>Typing Game</h1>
        <div class="container">
            <div class="settings item">
                <h2>Settings</h2>
               
                <input id="userinput" placeholder="Username"/><button id="addUser">add</button><br>
                <label for="nb">Number of words</label>
                <input type="number" id="nb" width="40" max="10" min="1" value="1"/><br/>
                <label for="len">Length of words</label>
                <input type="number" id="len" width="40" max="10" min="2" value="2"/><br/>
                <label for="languages">Languages</label>
                <select id="languages" title="languages"></select><br/>
                <label for="categories">Categories</label>
                <select id="categories" title="categories"></select>
            </div>
            <div class="item">
                <label for="users">User:</label>                
                <select id="users" name="selectusers">
                    <!-- <option id="defaut" value='Anonymous' selected="selected" disabled>Anonymous</option> -->
                </select>
                <p id="timer" class="">time:</p>
                <button id="startgame">Start</button><span id="userlevel"></span><br/>
                <p contenteditable="true" type="textarea" id="typedword">&nbsp;</p>
                <p id="randomword">&nbsp;</p>
            </div>
            <div class="item">&nbsp;
                <h2>Records</h2>
                    <ol id="allRecords"></ol>
                <h2>Leaders</h2>
                    <ol id="leaderboard"></ol>
            </div>
        </div>
    </body>
</html>
