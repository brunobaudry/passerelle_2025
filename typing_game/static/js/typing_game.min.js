this.onload=async()=>{let n="Anonymous",o="",t=500,a=t,r=0,l=0,s=[],c=!1,d=n,i=!1,u=!1,B="https://random-words-api.kushcreates.com",g=[],m=new Map,p=new Map,v=new Map,h=new Map,D=1,y=3,O=5,L=new Map,w=(L.set(0,160),L.set(1,80),L.set(2,50),L.set(3,20),document.querySelector("#randomword")),b=document.querySelector("#timer"),U=document.querySelector("#startgame"),k=document.querySelector("#userlevel"),q=document.querySelector("#allRecords"),E=document.querySelector("#leaderboard"),S=document.querySelector("#nb"),f=document.querySelector("#len"),$=document.querySelector("#languages"),C=document.querySelector("#categories"),M=document.querySelector("#typedword"),z=document.querySelector("#addUser"),x=document.querySelector("#users"),W=document.querySelector("#userinput");let A=()=>{var e=h.get(d);k.textContent="level "+v.get(d),S.value=e.contWords,f.value=e.wordLength},e=e=>{h.set(d,{contWords:parseInt(S.value),wordLength:parseInt(f.value)})},H=e=>{var t;console.log("initUser",e),-1==g.indexOf(e)?(0==g.indexOf(n)&&(g.length=0),g.push(e),(t=document.createElement("option")).value=e,(t.textContent=e)==n&&(t.disabled=!0),x.appendChild(t),x.selectedIndex=x.children.length-1,K(e),d=e,A(),T()):alert(e+" already exists, find another name !")},F=e=>{e.stopPropagation();var t=e.key;"Dead"===t?c=!0:(c=!1,"Enter"===t?J():0<r&&("Backspace"===e.key||"Delete"===e.key)&&(I(D),j(),Q(null)))},I=e=>{m.set(d,m.get(d)+e)},P=(t,n)=>{for(let e=0;e<t.length;e++)R(t[e],0===e,n)},R=(e,t,n)=>{var a=document.createElement("option");a.innerHTML=e,a.setAttribute("id",e),a.setAttribute("name","lang"),a.checked=t,n.appendChild(a),n.appendChild(document.createElement("br"))},G=()=>{var e=h.get(d);S.value=e.contWords,f.value=e.wordLength,b.classList=[],k.classList=[],M.focus()};async function J(){var e;clearInterval(l),G(),e=await(async()=>{let e=document.querySelector("[name='lang']:checked"),t="";f.value&&(t+="&length="+f.value),S.value&&(t+="&words="+S.value),e.value&&(t+="&language="+e.value),C.value&&(t+="&category="+C.value);{var[n,a=""]=["api",t];let e=B+"/"+n;return await(""!=a&&(e+="?"+a),n=await fetch(e),a=await n.json())}})(),o=e.map(e=>e.word).join(" "),T(),await!(w.innerHTML=o),console.log(!i,a,t,a!=t,!i&&a!=t),i||a==t||(I(y),j()),K(d),t=o.length*L.get(v.get(d))+20,r=0,a=t,l=setInterval(N,10),u=!0}let K=e=>{m.has(e)||m.set(e,0),p.has(e)||p.set(e,0),v.has(e)||v.set(e,0),h.has(e)||h.set(e,{contWords:1,wordLength:2})},T=()=>{w.innerHTML="",M.innerHTML=M.value=""};let N=()=>{r=(a--/100).toFixed(2),b.textContent="time: "+r+" s",r<=0&&_(!1)},Q=e=>{let t=M.textContent;u&&(null==e&&(t=t.slice(-1)),c||(w.innerHTML=V(t)),X(t))},V=t=>{let n="";var e=o.substring(t.length);for(let e=0;e<Math.min(o.length,t.length);e++){var a=t[e].replace(/ /g," ").charCodeAt(0),r=o[e].replace(/ /g," ").charCodeAt(0);n+=a==r?`<span class="correct">${o[e]}</span>`:`<span class="wrong">${o[e]}</span>`}return n+e},X=e=>{e===o&&(i=!0,_(i),Y(e))},Y=e=>{s.push({time:r,word:e,user:d}),s.sort((e,t)=>e.time-t.time),s=s.slice(0,6),q.innerHTML="",s.forEach(e=>{var t=document.createElement("li");t.textContent=e.time+"s "+e.user,t.classList.add("tooltip"),t.setAttribute("data-tooltip","Word(s): "+e.word),q.appendChild(t)})},Z=()=>{for(var e in E.innerHTML="",g){var e=g[e],t=(ee(e),document.createElement("li"));t.textContent=e+" "+p.get(e),t.classList.add("tooltip"),t.setAttribute("data-tooltip","level "+v.get(e)),E.appendChild(t)}},ee=e=>{var t,n=v.get(e);0<p.get(e)-10*(n+1)&&(t=h.get(d),h.set(d,{contWords:++t.contWords,wordLength:t.wordLength}),v.set(e,++n),k.classList.add("blink"),A())},_=e=>{u=!1,e?(b.classList.add("correct"),e=h.get(d),h.set(d,{contWords:e.contWords,wordLength:++e.wordLength}),p.set(d,p.get(d)+O)):(I(y),b.classList.add("wrong")),Z(),clearInterval(l),b.classList.add("blink"),M.blur(),j()},j=()=>{var t=m.get(d),e=50*(5-v.get(d)),n=(console.log(e),e/5);for(let e=0;e<5;e++){var a=document.getElementById("heart"+e),r=e*n,o=(e+1)*n;t<=r?a.style.opacity=1:o<=t?a.style.opacity=0:(a.style.opacity=1-(o=(t-r)/n),console.log(o))}};P(["en","es","hi","gu","de","fr","it","zh","pt-br"],$),P(["all","capitals_of_countries","countries","sports","animals","birds","softwares","programming_languages","games","pc_games","mobile_games","console_games","companies"],C),d=n,H(d),z.addEventListener("click",e=>{console.log("click",d),""!==W.value.trim()&&H(W.value)}),x.addEventListener("change",e=>{u&&_(!1),d=x.value,A(),T(),console.log(h)}),S.addEventListener("click",e),f.addEventListener("click",e),M.addEventListener("input",Q),U.addEventListener("click",J),document.addEventListener("keydown",F)};