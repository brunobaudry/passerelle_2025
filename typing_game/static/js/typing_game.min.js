this.onload=async()=>{let e="Anonymous",r="",t=500,n=t,a=0,o=0,l=0,s=[],c=!1,d=e,i=!1,u=!1,j="https://random-words-api.kushcreates.com",g=[],m=new Map,v=new Map,p=new Map,h=new Map,B=1,L=3,D=5,y=new Map,w=(y.set(0,160),y.set(1,80),y.set(2,50),y.set(3,20),document.querySelector("#randomword")),q=document.querySelector("#timer"),F=document.querySelector("#startgame"),E=document.querySelector("#userlevel"),S=document.querySelector("#allRecords"),k=document.querySelector("#leaderboard"),b=document.querySelector("#nb"),f=document.querySelector("#len"),P=document.querySelector("#languages"),M=document.querySelector("#categories"),C=document.querySelector("#typedword"),U=document.querySelector("#addUser"),x=document.querySelector("#users"),A=document.querySelector("#userinput");let H=()=>{var e=h.get(d);E.textContent="level "+p.get(d),b.value=e.contWords,f.value=e.wordLength},z=e=>{h.set(d,{contWords:parseInt(b.value),wordLength:parseInt(f.value)})},O=e=>{var t;console.log("initUser",e),-1==g.indexOf(e)?(g.push(e),(t=document.createElement("option")).value=e,t.textContent=e,x.appendChild(t),x.selectedIndex=x.children.length-1,Q(e),d=e,H(),W()):alert(e+" already exists, find another name !")},R=e=>{e.stopPropagation();var t=e.key;"Dead"===t?c=!0:(c=!1,"Enter"===t?N():0<a&&("Backspace"===e.key||"Delete"===e.key)&&(T(B),$(),X(null)))},T=e=>{m.set(d,m.get(d)+e)},G=(t,n)=>{for(let e=0;e<t.length;e++)J(t[e],0===e,n)},J=(e,t,n)=>{var a=document.createElement("option");a.innerHTML=e,a.setAttribute("id",e),a.setAttribute("name","lang"),a.checked=t,n.appendChild(a),n.appendChild(document.createElement("br"))},K=()=>{var e=h.get(d);b.value=e.contWords,f.value=e.wordLength,q.classList=[],E.classList=[],C.focus()};async function N(){var e;clearInterval(l),K(),e=await(async()=>{let e=document.querySelector("[name='lang']:checked"),t="";f.value&&(t+="&length="+f.value),b.value&&(t+="&words="+b.value),e.value&&(t+="&language="+e.value),M.value&&(t+="&category="+M.value);{var[n,a=""]=["api",t];let e=j+"/"+n;return await(""!=a&&(e+="?"+a),n=await fetch(e),a=await n.json())}})(),r=e.map(e=>e.word).join(" "),W(),await!(w.innerHTML=r),i||n==t||(T(L),$()),t=r.length*y.get(p.get(d))+20,a=0,n=t,l=setInterval(V,10),u=!0}let Q=e=>{m.has(e)||m.set(e,0),v.has(e)||v.set(e,0),p.has(e)||p.set(e,1),h.has(e)||h.set(e,{contWords:1,wordLength:2,gameover:!1})},W=()=>{w.innerHTML="",C.innerHTML=C.value=""};let V=()=>{a=(n--/100).toFixed(2),o=t-n,q.textContent=a+"s",a<=0?I(!1):n<.25*t&&(q.classList=["warn"])},X=e=>{let t=C.textContent;u&&(null==e&&(t=t.slice(-1)),c||(w.innerHTML=Y(t)),Z())},Y=t=>{let n="";var e=r.substring(t.length);for(let e=0;e<Math.min(r.length,t.length);e++){var a=t[e].replace(/ /g," ").charCodeAt(0),o=r[e].replace(/ /g," ").charCodeAt(0);n+=a==o?`<span class="correct">${r[e]}</span>`:`<span class="wrong">${r[e]}</span>`}return n+e},Z=()=>{C.textContent===r&&(i=!0,I(i))},ee=e=>{s.push({time:(o/e.length).toFixed(0),word:e,user:d}),s.sort((e,t)=>e.time-t.time),s=s.slice(0,6),S.innerHTML="",s.forEach(e=>{var t=document.createElement("tr");t.innerHTML=`<td>${e.user}</td><td>${e.time}</td>`,t.classList.add("tooltip"),t.setAttribute("data-tooltip","Word(s): "+e.word),S.appendChild(t)})},te=()=>{for(var e in k.innerHTML="",g){var e=g[e],t=(ne(e),document.createElement("tr"));t.innerHTML=`<td>${e}</td><td>${p.get(e)}</td><td>${100*v.get(e)}</td>`,t.classList.add("tooltip"),t.setAttribute("data-tooltip","Penalties "+m.get(e)),k.appendChild(t)}},ne=e=>{var t,n=p.get(e);0<v.get(e)-10*(n+1)&&(t=h.get(d),h.set(d,{contWords:++t.contWords,wordLength:t.wordLength}),p.set(e,++n),E.classList.add("blink"),H())},I=e=>{u=!1,e?(q.classList=["correct"],e=h.get(d),h.set(d,{contWords:e.contWords,wordLength:++e.wordLength}),v.set(d,v.get(d)+D),ee(C.textContent)):(T(L),q.classList=["wrong"]),clearInterval(l),q.classList.add("blink"),C.blur(),te(),$()},$=()=>{var t=m.get(d),n=50*(5-p.get(d))/2/5;for(let e=0;e<5;e++){var a=document.getElementById("heart"+e),o=e*n,r=(e+1)*n;t<=o?a.style.opacity=1:r<=t?(a.style.opacity=0,4==e&&(gameover=!0)):(a.style.opacity=1-(r=(t-o)/n),console.log(r))}};G(["en","es","hi","gu","de","fr","it","zh","pt-br"],P),G(["all","capitals_of_countries","countries","sports","animals","birds","softwares","programming_languages","games","pc_games","mobile_games","console_games","companies"],M),d=e,O(d),U.addEventListener("click",e=>{console.log("click",d),""!==A.value.trim()&&(u&&I(!1),O(A.value))}),x.addEventListener("change",e=>{u&&I(!1),d=x.value,H(),W(),console.log(h)}),b.addEventListener("click",z),f.addEventListener("click",z),C.addEventListener("input",X),F.addEventListener("click",N),document.addEventListener("keydown",R);var ae=document.querySelectorAll("[data-modal-open]"),oe=document.querySelectorAll("[data-modal-close]");let _=document.querySelector("#modalsettings");console.log(ae),ae.forEach(e=>e.addEventListener("click",e=>{e.target.closest("#settings")?(_=document.querySelector("#modalsettings"),console.log(e.target)):e.target.closest("#boards")&&(_=document.querySelector("#modalboards")),console.log(_.id),_.classList.add("active")})),oe.forEach(e=>e.addEventListener("click",()=>{_.classList.remove("active"),console.log(_)})),window.addEventListener("click",e=>{e.target===_&&(_.classList.remove("active"),console.log(_))})};